/*
作者：   Alt+ 
 时间： 2016-07-06 15:41:29 PM 
*/
define("2.0.0/js/plugins/iscroll5/scripts/iscroll-refresh.js",function(require,exports,module){var a=require("iscroll5");$.loadCss("2.0.0/js/plugins/iscroll5/css/iscroll-refresh.css");var b=function(b,c,d){function e(){B=z.tabScroller.children;for(var b,c=0,d=0;d<B.length;d++)c+=B[d].offsetWidth,B[d].style.width=B[d].offsetWidth+"px",b=B[d].tagName;c+=1,z.tabScroller.style.width=c+"px",A=new a(z.tabWrapper,{scrollX:!0,scrollY:!1,snap:b,tap:!0});var e=z.bdWrapper.children[0];D=z.bdWrapper.offsetWidth,E=z.bdWrapper.offsetHeight;var g=e.children;for(e.style.width=D*g.length+"px",d=0;d<g.length;d++){g[d].style.width=D+"px",g[d].style.height=E+"px",g[d].children[0].style.minHeight=E+"px",V[d]=new a(g[d],{probeType:3,tap:!0});var h=document.createElement("div");h.className=Y,h.innerHTML=P,g[d].appendChild(h);var i=document.createElement("div");i.className=Z,i.innerHTML=T,g[d].appendChild(i),V[d].on("scrollStart",s),V[d].on("scroll",t),V[d].on("scrollEnd",u),Q[d]=!1,U[d]=!1}C=new a(z.bdWrapper,{scrollX:!0,scrollY:!1,momentum:!1,snap:!0}),C.on("scrollEnd",r),f()}function f(){for(var a=0;a<B.length;a++)B[a].addEventListener("tap",function(a){a.preventDefault();var b=a.target||a.srcElement,c=z.index(b,B);C.goToPage(parseInt(c),0,500)},!1)}function g(a,b){_(a.scroller).animate({top:b+"px"},500)}function h(a,b){if("function"==typeof z.downTip){var c={scroll:a,index:C.currentPage.pageX,ele:k(a),tip:b};return void z.downTip(c)}k(a).querySelector(".tip b").innerHTML=b}function i(a,b){if(z.downAnimation){({scroll:a,index:C.currentPage.pageX,ele:k(a),status:b});return void z.downAnimation(param)}if(0==b){var c=a.y/O*180;k(a).querySelector(".ico i").style.transform="rotate("+c+"deg)"}}function k(a){return a.wrapper.querySelector("."+Y)}function l(a,b){if("function"==typeof z.upTip){var c={scroll:a,index:C.currentPage.pageX,ele:n(a),tip:b};return void z.upTip(c)}n(a).querySelector(".tip").innerHTML=b}function m(a,b){if(z.upAnimation){({scroll:a,index:C.currentPage.pageX,ele:n(a),status:b});return void z.upAnimation(param)}var c=180;0==b?(n(a).querySelector(".ico").className="ico",n(a).querySelector(".ico").style.transform="rotate("+c+"deg)"):1==b?(c=0,n(a).querySelector(".ico").className="ico",n(a).querySelector(".ico").style.transform="rotate("+c+"deg)"):2==b&&(n(a).querySelector(".ico").className="ico loading")}function n(a){return a.wrapper.querySelector("."+Z)}function o(a){if(K=!0,!Q[C.currentPage.pageX]){if(k(a).style.display="none",-80>F)return void(K=!1);for(var b=0;b<y.pullDown.except.length;b++)if(y.pullDown.except[b]==C.currentPage.pageX)return void(K=!1);I=a.scroller.getAttribute("noMore")?1:0;var c=(new Date).getTime();H=c,J=a.scroller.getAttribute("lastupdate")||c;var d=parseInt((c-J)/1e3);if(1===I&&d<=y.pullDown.nextTime)return void(K=!1);k(a).style.display="block",1==I&&a.scroller.setAttribute("noMore",0),h(a,y.pullDown.contentDown),K=!0;var e=new Date(parseInt(J)),f=e.getMonth()+1+"/"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();k(a).querySelector(".tip i").innerHTML="最后刷新："+f}}function p(a){if(L=!0,!U[C.currentPage.pageX]){if(n(a).style.display="none",F>a.maxScrollY+80)return void(L=!1);for(var b=0;b<y.pullUp.except.length;b++)if(y.pullUp.except[b]==C.currentPage.pageX)return void(L=!1);if(M=a.scroller.getAttribute("loadedAll")?1:0)return void(L=!1);n(a).style.display="block",l(a,y.pullUp.contentUp)}}function q(){if(!$)return!1;var a=(new Date).getTime(),b=a-H;return $=!(b>200)}function r(){var a=z.pageX=this.currentPage.pageX;A.scrollToElement(z.tabScroller.children[a],700,!0),z.tabScroller.querySelector(".active").className="",z.tabScroller.children[a].className="active",z.slideAction&&z.slideAction(C.currentPage.pageX),V[C.currentPage.pageX].enable()}function s(){X=!1,W=!1,F=this.y,G=C.x,o(this),p(this)}function t(){if(!q()){if(!X&&!W){var a=Math.abs(C.x-G),b=Math.abs(this.y-F);if(a>5||b>5){if(a>b)return this.disable(),this.scrollTo(0,F),void(W=!0);C.disable(),C.goToPage(C.currentPage.pageX,0),X=!0}}if(K&&(this.y>=O&&!N&&-1==this.directionY?(N=!0,h(this,y.pullDown.contentHover),i(this,1)):this.y<O&&this.y>=0&&(1===this.directionY&&(h(this,y.pullDown.contentDown),N=!1),N?this.scroller.style.top=O-this.y+"px":i(this,0))),L)if(this.y<=this.maxScrollY-S&&!R&&1==this.directionY)R=!0,l(this,y.pullUp.contentHover),m(this,1);else if(this.y>this.maxScrollY-S&&this.y<this.maxScrollY&&(-1===this.directionY&&(R=!1,l(this,y.pullUp.contentUp),m(this,0)),R)){var c=this.maxScrollY-this.y-S;this.scroller.style.top=c+"px"}}}function u(){C.enable();var a=this;if(N){h(a,y.pullDown.contentRefresh),i(this,2);var b=a.scroller.getAttribute("lastupdate");b||(b=0);var c={scroll:a,index:C.currentPage.pageX,lastUpdate:parseInt(b)};Q[c.index]=!0,w(c)}else if(R){l(a,y.pullUp.contentRefresh),m(a,2);var b=a.scroller.getAttribute("lastupdate");b||(b=0);var d=a.scroller.getAttribute("page");d||(d=0);var c={scroll:a,index:C.currentPage.pageX,lastUpdate:parseInt(b),page:parseInt(d)};U[c.index]=!0,v(c)}}function v(a){"function"==typeof z.upAction?z.upAction(a):setTimeout(function(){z.pullUpCallBack(a,1)},1e3)}function w(a){"function"==typeof z.downAction?z.downAction(a):setTimeout(function(){z.pullDownCallBack(a,1)},1e3)}function x(a,b,c){y.tabs=a,y.tabs_bd=b,z.tabWrapper="string"==typeof a?document.querySelector(a):a,z.tabScroller=z.tabWrapper.children[0],z.bdWrapper="string"==typeof b?document.querySelector(b):b,z.bdScroller=z.bdWrapper.children[0],"undefined"!=typeof c&&("undefined"!=typeof c.pullDown&&(y.pullDown.height="undefined"!=typeof c.pullDown.height?c.pullDown.height:y.pullDown.height,y.pullDown.nextTime="undefined"!=typeof c.pullDown.nextTime?c.pullDown.nextTime:y.pullDown.nextTime,y.pullDown.html="undefined"!=typeof c.pullDown.html?c.pullDown.html:y.pullDown.html,y.pullDown.except="undefined"!=typeof c.pullDown.except?c.pullDown.except:y.pullDown.except,y.pullDown.contentDown="undefined"!=typeof c.pullDown.contentDown?c.pullDown.contentDown:y.pullDown.contentDown,y.pullDown.contentHover="undefined"!=typeof c.pullDown.contentHover?c.pullDown.contentHover:y.pullDown.contentHover,y.pullDown.contentRefresh="undefined"!=typeof c.pullDown.contentRefresh?c.pullDown.contentRefresh:y.pullDown.contentRefresh,y.pullDown.contentNomore="undefined"!=typeof c.pullDown.contentNomore?c.pullDown.contentNomore:y.pullDown.contentNomore,y.pullDown.callback="undefined"!=typeof c.pullDown.callback?c.pullDown.callback:y.pullDown.callback,y.pullDown.animation="undefined"!=typeof c.pullDown.animation?c.pullDown.animation:y.pullDown.animation),"undefined"!=typeof c.pullUp&&(y.pullUp.height="undefined"!=typeof c.pullUp.height?c.pullUp.height:y.pullUp.height,y.pullUp.nextTime="undefined"!=typeof c.pullUp.nextTime?c.pullUp.nextTime:y.pullUp.nextTime,y.pullUp.html="undefined"!=typeof c.pullUp.html?c.pullUp.html:y.pullUp.html,y.pullUp.except="undefined"!=typeof c.pullUp.except?c.pullUp.except:y.pullUp.except,y.pullUp.contentUp="undefined"!=typeof c.pullUp.contentUp?c.pullUp.contentUp:y.pullUp.contentUp,y.pullUp.contentHover="undefined"!=typeof c.pullUp.contentHover?c.pullUp.contentHover:y.pullUp.contentHover,y.pullUp.contentRefresh="undefined"!=typeof c.pullUp.contentRefresh?c.pullUp.contentRefresh:y.pullUp.contentRefresh,y.pullUp.contentNomore="undefined"!=typeof c.pullUp.contentNomore?c.pullUp.contentNomore:y.pullUp.contentNomore,y.pullUp.callback="undefined"!=typeof c.pullUp.callback?c.pullUp.callback:y.pullUp.callback,y.pullUp.animation="undefined"!=typeof c.pullUp.animation?c.pullUp.animation:y.pullUp.animation)),e()}var y={pullDown:{height:60,nextTime:3600,html:'<span class="ico"><i></i></span><span class="tip"><b>下拉刷新...</b><i></i></span>',except:[],contentDown:"下拉刷新...",contentHover:"释放立即刷新...",contentRefresh:"正在刷新...",contentNomore:"没有更多新数据了...",callback:null,animation:null,tip:null},pullUp:{height:40,html:'<span class="ico"></span><span class="tip">上拉加载更多</span>',except:[],contentUp:"上拉加载更多...",contentHover:"释放立即加载...",contentRefresh:"正在加载...",contentNomore:"没有更多数据了...",callback:null,animation:null,tip:null},tabs:"tabs",tabs_bd:"tabs-bd",slide:null},z=this;z.pageX=0;var A,B,C,D,E,F,G,H,I,J,K,L,M,N=!1,O=y.pullDown.height,P=y.pullDown.html,Q=[],R=!1,S=y.pullUp.height,T=y.pullUp.html,U=[],V=[],W=!1,X=!1,Y="ir-down-tip",Z="ir-up-tip";z.index=function(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return c};var $=!0;this.pullDownCallBack=function(a,b){var c=a.scroll;N=!1,Q[a.index]=!1,"undefined"!=typeof b?(c.scroller.setAttribute("noMore","1"),h(c,y.pullDown.contentNomore),i(c,3),setTimeout(function(){g(c,0),c.refresh()},1e3)):setTimeout(function(){h(c,y.pullDown.contentDown),i(c,0),g(c,0),c.refresh()},1e3);var d=(new Date).getTime();c.scroller.setAttribute("lastupdate",d)},this.pullUpCallBack=function(a,b){var c=a.scroll;R=!1,U[a.index]=!1;var d=c.scroller.getAttribute("page");d||(d=0),c.scroller.setAttribute("page",parseInt(d)+1),"undefined"!=typeof b?(c.scroller.setAttribute("loadedAll","1"),l(c,y.pullUp.contentNomore),m(c,3),setTimeout(function(){g(c,0),m(c,0),c.refresh()},1e3)):setTimeout(function(){l(c,y.pullUp.contentUp),m(c,0),g(c,0),m(c,0),c.refresh()},1e3)};var _=function(a){var b,c=j=0,d={},e=function(a,b,c,d){return-c*(a/=d)*(a-2)+b};return d.execution=function(f,g,h){var i=(new Date).getTime(),k=h||500,l=parseInt(a.style[f])||0,m=g-l;!function(){var g=(new Date).getTime()-i;return g>k?(g=k,a.style[f]=e(g,l,m,k)+"px",++c==j&&b&&b.apply(a),d):(a.style[f]=e(g,l,m,k)+"px",void setTimeout(arguments.callee,10))}()},d.animate=function(a,c,e){b=e;for(var f in a)j++,d.execution(f,parseInt(a[f]),c)},d};return x(b,c,d),this.upAction=y.pullUp.callback,this.downAction=y.pullDown.callback,this.upAnimation=y.pullUp.animation,this.downAnimation=y.pullDown.animation,this.upTip=y.pullUp.tip,this.downTip=y.pullDown.tip,this.slideAction=y.slide,this.config=y,this.refresh=function(a){V[a].refresh()},this.setPage=function(a,b){"number"!=typeof b&&(b=1),V[a].scroller.setAttribute("page",b)},this.setNoMore=function(a){V[a].scroller.setAttribute("nomore",1)},this.setLoadedAll=function(a){V[a].scroller.setAttribute("loadedAll",1)},this.getDownTip=function(a){return k(V[a])},this.getUpTip=function(){return n(V[index])},this.slide=function(a,b){y.slide=a,"undefined"==typeof b&&a(C.currentPage.pageX)},this.bdScroll=C,this.bdScrolls=V,this.tabScroll=A,this};module.exports=b});
/*出品单位：深圳市思迪信息技术股份有限公司-前端Html5开发小组*/